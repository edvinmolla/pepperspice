{% extends "html/spec-comp/dashboard/index.html" %}
{% block content %}

<div class="main-content">

  

  <style>
    .hideme {
      visibility: hidden;
    }
    
    
    .myAlert-top{
        position: fixed;
        top: 50px; 
        left:30%;
        width: 50%;
        z-index: 101;
    }
    </style>
    
    
    <div class="myAlert-top alert hideme alert-warning">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
     {{ message_1 }}<br/>
     <small>{{ message_2 }}</small>
    </div>



  <form method="post" enctype="multipart/form-data" action="http://localhost:8000/dashboard/warehouse/">
    {% csrf_token %}
    <input type="file" name="file" id="zipfile" accept=".zip,.rar,.7zip,.sql,.tar.gz,.tar" />
    <button type="submit">Upload</button>
  </form>

  <div class="progress">
    <div id="progressbar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
  </div>

</div>

<script>
  $(document).ready(function() {

$('form').on('submit', function(event){
event.preventDefault();

var formData = new FormData($('form')[0]);
$.ajax({
xhr: function(){
var xhr = new window.XMLHttpRequest();
xhr.upload.addEventListener('progress', function(e){
if (e.lengthComputable){
  console.log('Bytes Loaded: ' + e.loaded);
  console.log('Total Size: ' + e.total);
  console.log('Percentage Uploadeed: ' + (e.loaded / e.total));

  var percent = Math.round((e.loaded / e.total) * 100);

  $('#progressbar').attr('aria-valuenow', percent).css('width', percent + '%').text(percent + '%');
  
  }
});


return xhr;
},
type : 'POST',
url: 'http://localhost:8000/dashboard/warehouse/',
data: formData,
processData: false,
contentType: false,
success: function(){
  alert('file uploaded');
}


});

});







  // $('#zipfile').on('change', function(evt) {
  //   var mb = 1000000
  //   var file_size = this.files[0].size
  //   console.log((file_size/mb).toPrecision(5) + ' Mb');
  // });
});


</script>

<script>
function dothis(){
  var one = document.getElementById('zipfile').value.split(':')[1].split('.')[0].split('\\')
var package_name = one[one.length-1];
var package_type = document.getElementById('zipfile').value.split(':')[1].split('.')[1];

// alert(package_name + ' - ' + package_type);
}
</script>

</div>


{% endblock %}